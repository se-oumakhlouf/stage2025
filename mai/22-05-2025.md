## âœ… TÃ¢ches effectuÃ©es

- Exploration de lâ€™API Microsoft Graph pour crÃ©er des rÃ©unions Teams via OAuth 2.0.
	
- ComprÃ©hension des prÃ©requis Azure : enregistrement dâ€™application, `client_id`, `client_secret`, `tenant_id`.
	
- RÃ©daction dâ€™exemples JSON pour la crÃ©ation de rÃ©unions Teams, en tenant compte de la structure correcte des participants.
	
- Analyse des limitations liÃ©es aux permissions, consentements et gestion des utilisateurs dans Azure AD.
	

## ğŸ“š Connaissances acquises

- Le **`tenant ID`** est lâ€™identifiant unique de lâ€™annuaire Azure AD de lâ€™organisation.
	
- Pour accÃ©der Ã  Microsoft Graph, il faut enregistrer une application dans Azure AD et obtenir :
		  
	- `client_id` (ID de lâ€™application)
		  
	  - `client_secret` (secret client)
		  
	  - `tenant_id` (ID Azure AD)
		
- Le **token OAuth 2.0** (application ou dÃ©lÃ©guÃ©) est obtenu via un appel HTTP POST au endpoint `/token` dâ€™Azure avec ces identifiants.
	
- Ce token dâ€™accÃ¨s a une durÃ©e de vie limitÃ©e (~1 heure) et doit Ãªtre inclus dans lâ€™en-tÃªte `Authorization` des requÃªtes Microsoft Graph.
	
- Pour crÃ©er une rÃ©union Teams **au nom dâ€™un utilisateur**, il faut utiliser lâ€™endpoint :
		
	- Seule une application avec la permission **`OnlineMeetings.ReadWrite.All`** (consentement admin requis) peut crÃ©er des rÃ©unions au nom dâ€™utilisateurs internes.
		
	- Il est nÃ©cessaire de cibler un utilisateur existant dans le tenant (via son `userId` ou son `userPrincipalName` â€” gÃ©nÃ©ralement son email).
		
	- Les participants dans le corps JSON doivent Ãªtre indiquÃ©s avec leurs identitÃ©s prÃ©cises (ID Azure AD ou UPN). Lâ€™API ne supporte pas directement juste un email libre pour les participants.
		
	- Le lien gÃ©nÃ©rÃ© pour la rÃ©union est universel et peut Ãªtre partagÃ© avec nâ€™importe qui, mÃªme externe au tenant, sans que ces derniers aient besoin dâ€™un compte Microsoft ou Azure AD.
		
	- **Important** : On ne peut pas crÃ©er de rÃ©union Teams â€œau nomâ€ dâ€™un utilisateur externe non invitÃ© ou hors du tenant sans invitation B2B prÃ©alable.
	

## ğŸ ProblÃ¨mes rencontrÃ©s / Limitations

- Lâ€™accÃ¨s au portail Azure et la gestion des permissions peuvent Ãªtre restreints par la politique dâ€™entreprise.
	
- La crÃ©ation de rÃ©unions via lâ€™API nÃ©cessite un consentement admin pour la permission `OnlineMeetings.ReadWrite.All`.
	
- Il est impossible de crÃ©er une rÃ©union Teams â€œau nomâ€ dâ€™un utilisateur sans avoir son identifiant dans Azure AD (le mail seul nâ€™est pas toujours suffisant).
	
- Pas de possibilitÃ© de contourner le consentement utilisateur pour les actions sensibles.
	
- Les participants doivent Ãªtre utilisateurs Azure AD ou invitÃ©s B2B (avec identifiants).
	
- Pas de prise en charge officielle pour ajouter des participants â€œlibresâ€ uniquement par email dans la requÃªte API.
	
- **Surtout, il nâ€™est pas raisonnable ni sÃ©curisÃ©** que tous les utilisateurs soient **enregistrÃ©s dans lâ€™application avec des droits de modification** sur leur compte ou leurs rÃ©unions.  Cela poserait de sÃ©rieux problÃ¨mes de confidentialitÃ©, de gestion des accÃ¨s, et de gouvernance des donnÃ©es.  En pratique, demander Ã  chaque utilisateur dâ€™accorder des droits Ã©tendus Ã  une application centralisÃ©e nâ€™est ni scalable, ni conforme Ã  la plupart des politiques de sÃ©curitÃ© en entreprise.
	

## ğŸ”œ Ã€ faire demain

- Envoie de mail via Scaleway
	

## ğŸ§© Notes / Code

```json
{
"startDateTime": "2025-05-23T14:00:00Z",
"endDateTime": "2025-05-23T15:00:00Z",
"subject": "RÃ©union individuelle",
"participants": {
  "organizer": {
    "identity": {
      "user": {
        "id": "organizer-user-id-azure-ad"
      }
    }
  },
  "attendees": [
    {
      "identity": {
        "user": {
          "id": "attendee-user-id-azure-ad"
        }
      }
    }
  ]
}
}
```
