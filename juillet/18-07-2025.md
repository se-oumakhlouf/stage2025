## âœ… TÃ¢ches effectuÃ©es

- Suppression du champ `Links.is_Available`, on se base uniquement sur `Link.meeting_id` dans le back et on envoie toujours le mÃªme `LinkResponseDto` avec un boolean `isAvailable` :
	- Pas besoin d'exposer le `L.meeting_id` dans le front
	- Pas besoin de modifier la logique du front car la forme du `LinkResponseDto` ne change pas
	
- Ajouts d'indexes sur les `FKs` -> Ã©norme gain de performance pour `Meetings.deleteAll()`
	
- 


---

## ğŸ“š Connaissances acquises

- `PostreSQL` ne fait pas de crÃ©ation automatique d'indexes sur les `foreign keys` des tables
	
- `SSE` pour envoyer des donnÃ©es par waves au front.
	

---

## ğŸ ProblÃ¨mes rencontrÃ©s

- 
	

---

## ğŸ”œ Ã€ faire demain

- 
	

---

## ğŸ§© Notes / Code

```java
// LinkRepository

@Query(value = """   
    select * from links l  
    where (:isAvailable = true and l.meeting_id is null)    or (:isAvailable = false and l.meeting_id is not null)    """, nativeQuery = true)  
Page<Link> findAllByIsAvailable (@Param("isAvailable") boolean isAvailable, Pageable pageable);


// LinkMapper

public static LinkResponseDto toLinkResponseDto(Link link) {  
  boolean isAvailable = link.getMeetingId() == null;  
  return new LinkResponseDto(  
      link.getId(),  
      link.getLink(),  
      isAvailable,  
      link.getLastReset()  
  );  
}
```

```SQL
explain analyze delete from meetings;
```
```txt
# Suppression avec indexes sur les FKs

                                                  QUERY PLAN
---------------------------------------------------------------------------------------------------------------
 Delete on meetings  (cost=0.00..86.95 rows=0 width=0) (actual time=3.325..3.326 rows=0 loops=1)
   ->  Seq Scan on meetings  (cost=0.00..86.95 rows=3995 width=6) (actual time=0.019..0.577 rows=5000 loops=1)
 Planning Time: 0.163 ms
 Trigger for constraint mails_meeting_id_fkey: time=14.293 calls=5000
 Trigger for constraint fk_meetinguser: time=78.740 calls=5000
 Trigger for constraint fk_meetinglink: time=39.480 calls=5000
 Execution Time: 136.424 ms
(7 rows)
```
